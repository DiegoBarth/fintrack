import{T as e,w as t}from"./react-query-B5bzpzJa.js";import{b as n,n as r,r as i,s as a}from"./vendor-react-u-2Pnofo.js";import{i as o,s}from"./index-BMGv8P3P.js";import"./createLucideIcon-DIUIV8YK.js";import{t as c}from"./Layout-BoL1MNLb.js";import"./chevron-right-DzDQO_nA.js";import{c as l,d as u,f as d,g as f,h as p,l as m,m as h,n as g,o as _,p as v,r as y,s as b,t as x,u as S}from"./SkeletonList-C9gNh93v.js";import{t as C}from"./plus-_D9Bpsd5.js";import"./x-DKWcFa7g.js";import{a as w,n as T}from"./PeriodContext-DZtup9TT.js";import{r as E,s as D,t as O}from"./formatters-DVAU20Gu.js";import{n as k,r as A,t as j}from"./DateField-C-M_oAib.js";import"./clsx-C7a_t6ND.js";import"./utils-DFP6x-mX.js";import{t as M}from"./ConfirmModal-DSNM3NTe.js";import"./Skeleton-D5FaXslB.js";import{n as N,t as P}from"./CustomSelect-BksPrye4.js";var F=e(),I=t();const L=(0,F.memo)(function({expenses:e,onSelect:t}){return(0,I.jsx)(f,{itens:e,emptyText:`Nenhum gasto cadastrado`,keyExtractor:e=>e.rowIndex,renderMobileItem:(0,F.useCallback)(e=>(0,I.jsxs)(p,{onClick:()=>t(e),className:`p-3`,children:[(0,I.jsx)(h,{title:e.description,right:(0,I.jsx)(`span`,{className:`text-red-600 dark:text-red-400`,children:D(e.amount)})}),(0,I.jsx)(v,{left:(0,I.jsxs)(`span`,{className:`text-green-700 dark:text-green-400`,children:[`Pago em `,e.paymentDate,` • `,e.category]}),right:(0,I.jsx)(`span`,{className:`text-green-700 dark:text-green-400 font-medium`,children:`Pago`})})]}),[t]),renderDesktopItem:(0,F.useCallback)(e=>(0,I.jsxs)(d,{onClick:()=>t(e),children:[(0,I.jsx)(u,{children:e.description}),(0,I.jsx)(S,{span:2,children:e.category??`-`}),(0,I.jsx)(S,{span:2,children:(0,I.jsxs)(`span`,{className:`text-green-700 dark:text-green-400`,children:[`Pago em `,e.paymentDate]})}),(0,I.jsx)(m,{children:(0,I.jsx)(`span`,{className:`text-red-600 dark:text-red-400 font-semibold`,children:D(e.amount)})}),(0,I.jsx)(N,{children:(0,I.jsx)(`span`,{className:`text-green-700 dark:text-green-400 font-semibold`,children:`Pago`})})]}),[t])})}),R=b({description:l().trim().min(1,`A Descrição é obrigatória`),amount:_().positive(`O Valor é obrigatório`),category:l().min(1,`A Categoria é obrigatória`),paymentDate:y({message:`A Data de pagamento é obrigatória`})});var z={description:``,category:``,paymentDate:``,amount:``};function B({isOpen:e,onClose:t}){let{month:n,year:a}=T(),{create:c,isSaving:l}=w(n,String(a)),u=o(),{validate:d}=g(),{control:f,register:p,handleSubmit:m,reset:h}=i({defaultValues:z});return(0,F.useEffect)(()=>{e||h(z)},[e,h]),(0,I.jsx)(A,{isOpen:e,onClose:t,title:`Novo Gasto`,type:`create`,isLoading:l,onSave:m(async e=>{let n=d(R,{description:e.description,category:e.category,amount:O(String(e.amount)),paymentDate:e.paymentDate});n&&(await c(n),u.success(`Gasto criado com sucesso!`),h(z),t())}),children:(0,I.jsxs)(`div`,{className:`space-y-4`,children:[(0,I.jsxs)(`div`,{children:[(0,I.jsx)(`label`,{htmlFor:`expense-description`,className:`block text-xs font-medium text-muted-foreground mb-1`,children:`Descrição *`}),(0,I.jsx)(`input`,{id:`expense-description`,"aria-required":`true`,placeholder:`Ex: Aluguel, Supermercado`,autoComplete:`off`,className:`w-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900\r
                     dark:text-gray-100 rounded-md p-2`,...p(`description`)})]}),(0,I.jsxs)(`div`,{children:[(0,I.jsx)(`label`,{htmlFor:`expense-amount`,className:`block text-xs font-medium text-muted-foreground mb-1`,children:`Valor *`}),(0,I.jsx)(r,{name:`amount`,control:f,render:({field:e})=>(0,I.jsx)(`input`,{id:`expense-amount`,"aria-required":`true`,"aria-label":`Valor do gasto em reais`,className:`w-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900\r
                           dark:text-gray-100 rounded-md p-2`,autoComplete:`off`,value:e.value,onChange:t=>e.onChange(E(t.target.value))})})]}),(0,I.jsxs)(`div`,{children:[(0,I.jsx)(`label`,{id:`expense-category-label`,className:`block text-xs font-medium text-muted-foreground mb-1`,children:`Categoria *`}),(0,I.jsx)(r,{name:`category`,control:f,render:({field:e})=>(0,I.jsx)(P,{id:`expense-category`,label:`Categoria do gasto`,value:e.value,onChange:e.onChange,options:s})})]}),(0,I.jsxs)(`div`,{children:[(0,I.jsx)(`label`,{htmlFor:`expense-payment-date`,className:`block text-xs font-medium text-muted-foreground mb-1`,children:`Data de pagamento *`}),(0,I.jsx)(r,{control:f,name:`paymentDate`,render:({field:e})=>(0,I.jsx)(j,{value:e.value?new Date(e.value):void 0,onChange:t=>e.onChange(t)})})]})]})})}function V({isOpen:e,expense:t,onClose:n}){let{month:r,year:i}=T(),{update:a,remove:s,isSaving:c,isDeleting:l}=w(r,String(i)),[u,d]=(0,F.useState)(!1),f=o(),[p,m]=(0,F.useState)(``);(0,F.useEffect)(()=>{t&&m(D(t.amount))},[t]);let h=async()=>{await a({rowIndex:t.rowIndex,amount:O(p)}),f.success(`Gasto atualizado com sucesso!`),m(``),n()},g=()=>{d(!0)},_=async()=>{await s(t.rowIndex),f.success(`Gasto excluído com sucesso!`),m(``),n()};if(!t)return null;let v=c||l;return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(A,{isOpen:e,onClose:n,title:t.description,type:`edit`,isLoading:v,loadingText:c?`Salvando...`:l?`Excluindo...`:void 0,onSave:h,onDelete:g,children:(0,I.jsxs)(`div`,{children:[(0,I.jsxs)(`div`,{className:`-mt-4 flex items-center justify-between bg-muted/30 p-3 rounded-lg border border-dashed text-xs text-muted-foreground`,children:[(0,I.jsxs)(`div`,{children:[`Categoria: `,(0,I.jsx)(`span`,{className:`font-medium text-foreground`,children:t.category})]}),(0,I.jsxs)(`div`,{children:[`Data original: `,(0,I.jsx)(`span`,{className:`font-medium text-foreground`,children:t.paymentDate})]})]}),(0,I.jsxs)(`div`,{children:[(0,I.jsx)(`label`,{htmlFor:`edit-expense-amount`,className:`block text-xs font-medium text-muted-foreground mb-1`,children:`Valor`}),(0,I.jsx)(`input`,{id:`edit-expense-amount`,"aria-label":`Valor do gasto em reais`,className:`w-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900\r
                     dark:text-gray-100 rounded-md p-2 focus:ring-2`,value:p,onChange:e=>m(E(e.target.value))})]})]})}),(0,I.jsx)(M,{isOpen:u,onClose:()=>d(!1),title:`Excluir gasto`,message:`Tem certeza que deseja excluir este gasto? Essa ação não poderá ser desfeita.`,confirmLabel:`Excluir`,onConfirm:_,loading:l})]})}function H(){let{month:e,year:t}=T(),{expenses:r,isLoading:i}=w(e,String(t)),o=n(),s=()=>o(`/`),[l,u]=(0,F.useState)(null),[d,f]=(0,F.useState)(!1),p=(0,F.useMemo)(()=>{let n=e===`all`?String(t):a(new Date(Number(t),Number(e)-1,1),`MMMM 'de' yyyy`,{locale:k});return`${e===`all`?n:n.charAt(0).toUpperCase()+n.slice(1)} • Total: ${D(r.reduce((e,t)=>e+Number(t.amount),0))}`},[e,t,r]);return i?(0,I.jsx)(c,{title:`Gastos`,onBack:s,children:(0,I.jsx)(x,{})}):(0,I.jsxs)(c,{title:`Gastos`,onBack:s,subtitle:p,headerVariant:`expense`,children:[(0,I.jsx)(`div`,{className:`pt-1 pb-20`,children:(0,I.jsx)(L,{expenses:r,onSelect:u})}),(0,I.jsx)(`button`,{type:`button`,onClick:()=>f(!0),className:`fixed bottom-6 right-6 z-50 flex h-14 w-14 items-center justify-center rounded-full bg-red-600 text-white shadow-lg transition-all hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600 hover:shadow-xl focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900`,"aria-label":`Novo gasto`,children:(0,I.jsx)(C,{className:`h-7 w-7`})}),(0,I.jsx)(B,{isOpen:d,onClose:()=>f(!1)}),(0,I.jsx)(V,{isOpen:!!l,expense:l,onClose:()=>u(null)})]})}export{H as default};