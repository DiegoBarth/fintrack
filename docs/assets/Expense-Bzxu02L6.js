import{T as e,w as t}from"./react-query-B5bzpzJa.js";import{b as n,n as r,o as i,t as a}from"./vendor-react-DA-XzSwC.js";import{a as o,c as s,d as c,f as l,h as u,l as d,m as f,n as p,o as m,p as h,s as g,t as _,u as v}from"./useValidation-qnHrZkSo.js";import{t as y}from"./plus-D9KzV0mC.js";import"./x-B-rujbE9.js";import{O as b,S as x,T as S,_ as C,i as w,m as T,r as E,x as D,y as O}from"./index--IbD_1Ym.js";import{n as k,r as A,t as j}from"./DateField-DFluzvmP.js";import{t as M}from"./ConfirmModal-BFsQqkwP.js";import{n as N,t as P}from"./CustomSelect-jT-_97Sc.js";var F=e(),I=t();const L=(0,F.memo)(function({expenses:e,onSelect:t}){return(0,I.jsx)(u,{itens:e,emptyText:`Nenhum gasto cadastrado`,keyExtractor:e=>e.rowIndex,renderMobileItem:(0,F.useCallback)(e=>(0,I.jsxs)(f,{onClick:()=>t(e),className:`p-3`,children:[(0,I.jsx)(h,{title:e.description,right:(0,I.jsx)(`span`,{className:`text-red-600 dark:text-red-400`,children:x(e.amount)})}),(0,I.jsx)(l,{left:(0,I.jsxs)(`span`,{className:`text-green-700 dark:text-green-400`,children:[`Pago em `,e.paymentDate,` • `,e.category]}),right:(0,I.jsx)(`span`,{className:`text-green-700 dark:text-green-400 font-medium`,children:`Pago`})})]}),[t]),renderDesktopItem:(0,F.useCallback)(e=>(0,I.jsxs)(c,{onClick:()=>t(e),children:[(0,I.jsx)(v,{children:e.description}),(0,I.jsx)(d,{span:2,children:e.category??`-`}),(0,I.jsx)(d,{span:2,children:(0,I.jsxs)(`span`,{className:`text-green-700 dark:text-green-400`,children:[`Pago em `,e.paymentDate]})}),(0,I.jsx)(s,{children:(0,I.jsx)(`span`,{className:`text-red-600 dark:text-red-400 font-semibold`,children:x(e.amount)})}),(0,I.jsx)(N,{children:(0,I.jsx)(`span`,{className:`text-green-700 dark:text-green-400 font-semibold`,children:`Pago`})})]}),[t])})}),R=m({description:g().trim().min(1,`A Descrição é obrigatória`),amount:o().positive(`O Valor é obrigatório`),category:g().min(1,`A Categoria é obrigatória`),paymentDate:p({message:`A Data de pagamento é obrigatória`})});var z={description:``,category:``,paymentDate:``,amount:``};function B({isOpen:e,onClose:t}){let{month:n,year:i}=T(),{create:o,isSaving:s}=C(n,String(i)),c=S(),{validate:l}=_(),{control:u,register:d,handleSubmit:f,reset:p}=r({defaultValues:z});return(0,F.useEffect)(()=>{e||p(z)},[e,p]),(0,I.jsx)(A,{isOpen:e,onClose:t,title:`Novo Gasto`,type:`create`,isLoading:s,onSave:f(async e=>{let n=l(R,{description:e.description,category:e.category,amount:O(String(e.amount)),paymentDate:e.paymentDate});n&&(await o(n),c.success(`Gasto criado com sucesso!`),p(z),t())}),children:(0,I.jsxs)(`div`,{className:`space-y-4`,children:[(0,I.jsxs)(`div`,{children:[(0,I.jsx)(`label`,{htmlFor:`expense-description`,className:`block text-xs font-medium text-muted-foreground mb-1`,children:`Descrição *`}),(0,I.jsx)(`input`,{id:`expense-description`,"aria-required":`true`,placeholder:`Ex: Aluguel, Supermercado`,autoComplete:`off`,className:`w-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900\r
                     dark:text-gray-100 rounded-md p-2`,...d(`description`)})]}),(0,I.jsxs)(`div`,{children:[(0,I.jsx)(`label`,{htmlFor:`expense-amount`,className:`block text-xs font-medium text-muted-foreground mb-1`,children:`Valor *`}),(0,I.jsx)(a,{name:`amount`,control:u,render:({field:e})=>(0,I.jsx)(`input`,{id:`expense-amount`,"aria-required":`true`,"aria-label":`Valor do gasto em reais`,className:`w-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900\r
                           dark:text-gray-100 rounded-md p-2`,autoComplete:`off`,value:e.value,onChange:t=>e.onChange(D(t.target.value))})})]}),(0,I.jsxs)(`div`,{children:[(0,I.jsx)(`label`,{id:`expense-category-label`,className:`block text-xs font-medium text-muted-foreground mb-1`,children:`Categoria *`}),(0,I.jsx)(a,{name:`category`,control:u,render:({field:e})=>(0,I.jsx)(P,{id:`expense-category`,label:`Categoria do gasto`,value:e.value,onChange:e.onChange,options:b})})]}),(0,I.jsxs)(`div`,{children:[(0,I.jsx)(`label`,{htmlFor:`expense-payment-date`,className:`block text-xs font-medium text-muted-foreground mb-1`,children:`Data de pagamento *`}),(0,I.jsx)(a,{control:u,name:`paymentDate`,render:({field:e})=>(0,I.jsx)(j,{value:e.value?new Date(e.value):void 0,onChange:t=>e.onChange(t)})})]})]})})}function V({isOpen:e,expense:t,onClose:n}){let{month:r,year:i}=T(),{update:a,remove:o,isSaving:s,isDeleting:c}=C(r,String(i)),[l,u]=(0,F.useState)(!1),d=S(),[f,p]=(0,F.useState)(``);(0,F.useEffect)(()=>{t&&p(x(t.amount))},[t]);let m=async()=>{await a({rowIndex:t.rowIndex,amount:O(f)}),d.success(`Gasto atualizado com sucesso!`),p(``),n()},h=()=>{u(!0)},g=async()=>{await o(t.rowIndex),d.success(`Gasto excluído com sucesso!`),p(``),n()};if(!t)return null;let _=s||c;return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(A,{isOpen:e,onClose:n,title:t.description,type:`edit`,isLoading:_,loadingText:s?`Salvando...`:c?`Excluindo...`:void 0,onSave:m,onDelete:h,children:(0,I.jsxs)(`div`,{children:[(0,I.jsxs)(`div`,{className:`-mt-4 flex items-center justify-between bg-muted/30 p-3 rounded-lg border border-dashed text-xs text-muted-foreground`,children:[(0,I.jsxs)(`div`,{children:[`Categoria: `,(0,I.jsx)(`span`,{className:`font-medium text-foreground`,children:t.category})]}),(0,I.jsxs)(`div`,{children:[`Data original: `,(0,I.jsx)(`span`,{className:`font-medium text-foreground`,children:t.paymentDate})]})]}),(0,I.jsxs)(`div`,{children:[(0,I.jsx)(`label`,{htmlFor:`edit-expense-amount`,className:`block text-xs font-medium text-muted-foreground mb-1`,children:`Valor`}),(0,I.jsx)(`input`,{id:`edit-expense-amount`,"aria-label":`Valor do gasto em reais`,className:`w-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900\r
                     dark:text-gray-100 rounded-md p-2 focus:ring-2`,value:f,onChange:e=>p(D(e.target.value))})]})]})}),(0,I.jsx)(M,{isOpen:l,onClose:()=>u(!1),title:`Excluir gasto`,message:`Tem certeza que deseja excluir este gasto? Essa ação não poderá ser desfeita.`,confirmLabel:`Excluir`,onConfirm:g,loading:c})]})}function H(){let{month:e,year:t}=T(),{expenses:r,isLoading:a}=C(e,String(t)),o=n(),s=()=>o(`/`),[c,l]=(0,F.useState)(null),[u,d]=(0,F.useState)(!1),f=(0,F.useMemo)(()=>{let n=e===`all`?String(t):i(new Date(Number(t),Number(e)-1,1),`MMMM 'de' yyyy`,{locale:k});return`${e===`all`?n:n.charAt(0).toUpperCase()+n.slice(1)} • Total: ${x(r.reduce((e,t)=>e+Number(t.amount),0))}`},[e,t,r]);return a?(0,I.jsx)(w,{title:`Gastos`,onBack:s,headerVariant:`expense`,children:(0,I.jsx)(E,{})}):(0,I.jsxs)(w,{title:`Gastos`,onBack:s,subtitle:f,headerVariant:`expense`,children:[(0,I.jsx)(`div`,{className:`pt-1 pb-20`,children:(0,I.jsx)(L,{expenses:r,onSelect:l})}),(0,I.jsx)(`button`,{type:`button`,onClick:()=>d(!0),className:`fixed bottom-6 right-6 z-50 flex h-14 w-14 items-center justify-center rounded-full bg-red-600 text-white shadow-lg transition-all hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600 hover:shadow-xl focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900`,"aria-label":`Novo gasto`,children:(0,I.jsx)(y,{className:`h-7 w-7`})}),(0,I.jsx)(B,{isOpen:u,onClose:()=>d(!1)}),(0,I.jsx)(V,{isOpen:!!c,expense:c,onClose:()=>l(null)})]})}export{H as default};