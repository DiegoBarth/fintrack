<!DOCTYPE html>
<html lang="pt-br">

<head>
   <meta charset="UTF-8">
   <title>FinTrack</title>
   <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>

   <h2>Novo gasto</h2>

   <form id="form">
      <input type="date" id="date" required><br><br>
      <input type="text" id="description" placeholder="Descri√ß√£o" required><br><br>
      <input type="text" id="category" placeholder="Categoria"><br><br>
      <input type="number" step="0.01" id="value" placeholder="Valor" required><br><br>

      <select id="person">
         <option>Diego</option>
         <option>Pamela</option>
      </select><br><br>

      <button>Salvar</button>
   </form>

   <p id="msg"></p>
   <hr>

   <h2>Consultar gastos</h2>

   <select id="month">
      <option value="1">Janeiro</option>
      <option value="2">Fevereiro</option>
      <option value="3">Mar√ßo</option>
      <option value="4">Abril</option>
      <option value="5">Maio</option>
      <option value="6">Junho</option>
      <option value="7">Julho</option>
      <option value="8">Agosto</option>
      <option value="9">Setembro</option>
      <option value="10">Outubro</option>
      <option value="11">Novembro</option>
      <option value="12">Dezembro</option>
   </select>

   <input type="number" id="year" value="2026">

   <button onclick="listExpenses()">Buscar</button>

   <ul id="list"></ul>

   <script>
      const URL = 'https://script.google.com/macros/s/AKfycbztaKHZIjuxK2RGcV95gsa07GwzPyWGPqjMnoNWFGYBh_GCF-7aZFyH2_apwLZCdpAhQg/exec';

      document.getElementById('form').addEventListener('submit', async e => {
         e.preventDefault();

         const payload = {
            data: date.value,
            descricao: description.value,
            categoria: category.value,
            valor: value.value,
            pessoa: person.value
         };

         await fetch(URL, {
            method: 'POST',
            body: JSON.stringify(payload)
         });

         msg.innerText = 'Gasto salvo üí∏';
         e.target.reset();
      });
      async function listExpenses() {
         const month = document.getElementById('month').value;
         const year  = document.getElementById('year').value;

         const res  = await fetch(`${URL}?month=${month}&year=${year}`);
         const data = await res.json();

         list.innerHTML = '';

         data.forEach(l => {
            const li = document.createElement('li');
            li.innerText = `${l[1]} - ${l[2]} - R$ ${l[4]} (${l[5]})`;
            list.appendChild(li);
         });
      }

   </script>

</body>

</html>