const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AddCommitmentModal-D87pCT7W.js","assets/index-BQF6qAAf.js","assets/vendor-react-g7Jl8uRT.js","assets/react-query-Bs2h8zdQ.js","assets/rolldown-runtime-DGruFWvd.js","assets/vendor-react-Chw94eNX.css","assets/index-DNgVfzb8.css","assets/pt-BR-VEqVFqnh.js","assets/useValidation-DymPpVvq.js","assets/CustomSelect-C8h44WIu.js","assets/DateField-OlGGwIZX.js","assets/ModalBase-Cl5-DtIa.js","assets/MonthField-BxUARqsh.js","assets/EditCommitmentModal-CMFSr39Z.js","assets/x-Bm1uByTJ.js","assets/ScopeChoiceModal-Da4A7Scu.js","assets/ConfirmModal-B7cfTyMg.js"])))=>i.map(i=>d[i]);
import{T as e,w as t}from"./react-query-Bs2h8zdQ.js";import{b as n,i as r,x as i}from"./vendor-react-g7Jl8uRT.js";import{a,c as o,i as s,n as c,o as l,r as u,s as d,t as f}from"./ListColValue-Ba5UNh4b.js";import{t as p}from"./plus-DiX1nk_H.js";import{t as m}from"./wallet-CBn7M046.js";import{A as h,C as g,O as _,_ as v,a as y,c as b,h as x,n as S,s as C,x as w}from"./index-BQF6qAAf.js";import{t as T}from"./pt-BR-VEqVFqnh.js";import{t as E}from"./ListColStatus-kEdSY6N1.js";var D=e(),O=t();function k(e){let[t,n,r]=e.split(`/`).map(Number),i=new Date(r,n-1,t);i.setHours(0,0,0,0);let a=new Date;return a.setHours(0,0,0,0),i<a}const A=(0,D.memo)(function({commitments:e,onSelect:t}){return(0,O.jsx)(o,{itens:e,emptyText:`Nenhum compromisso cadastrado`,keyExtractor:e=>e.rowIndex,renderMobileItem:(0,D.useCallback)(e=>{let n=!!e.paymentDate,r=e.type===`Cartão`,i=!n&&k(e.dueDate);return(0,O.jsxs)(d,{onClick:()=>t(e),variant:n?`success`:i?`danger`:`warning`,className:`p-3`,children:[(0,O.jsx)(l,{title:e.description,right:g(e.amount)}),(0,O.jsx)(`div`,{className:`mt-1 text-xs text-muted-foreground ${r?`min-h-[1rem]`:``}`,children:r?(0,O.jsxs)(`span`,{children:[e.card,(e.totalInstallments??1)>1&&(0,O.jsxs)(O.Fragment,{children:[` • Parcela `,e.installment,`/`,e.totalInstallments]})]}):(0,O.jsx)(`span`,{children:e.type})}),(0,O.jsx)(a,{left:(0,O.jsxs)(`div`,{className:`flex flex-col text-xs mt-1`,children:[(0,O.jsxs)(`span`,{className:i?`text-red-700 dark:text-red-300`:`text-amber-700 dark:text-amber-400`,children:[`Vence em `,e.dueDate]}),(0,O.jsx)(`span`,{className:`text-green-700 dark:text-green-400 ${n?``:`invisible select-none`}`,children:n?`Pago em ${e.paymentDate}`:`Aguardando`})]}),right:(0,O.jsx)(`div`,{className:`flex flex-col items-end gap-1`,children:(0,O.jsx)(`span`,{className:`font-medium text-sm
                           ${n&&`text-green-700 dark:text-green-400`}
                           ${i&&`text-red-600 dark:text-red-400`}
                           ${!n&&!i&&`text-amber-700 dark:text-amber-400`}
                        `,children:n?`Pago`:i?`Vencido`:`Em aberto`})})})]})},[t]),renderDesktopItem:(0,D.useCallback)(e=>{let n=!!e.paymentDate,r=!n&&k(e.dueDate);return(0,O.jsxs)(s,{onClick:()=>t(e),variant:n?`success`:r?`danger`:`default`,children:[(0,O.jsx)(u,{children:e.description}),(0,O.jsx)(c,{span:2,children:e.type}),(0,O.jsx)(c,{span:2,children:(0,O.jsx)(`span`,{className:n?`text-green-700 dark:text-green-400`:r?`text-red-700 dark:text-red-300`:`text-amber-700 dark:text-amber-400`,children:n?`Pago em ${e.paymentDate}`:`Vence em ${e.dueDate}`})}),(0,O.jsx)(f,{children:g(e.amount)}),(0,O.jsx)(E,{children:(0,O.jsx)(`span`,{className:`font-semibold
                     ${n&&`text-green-700 dark:text-green-400`}
                     ${r&&`text-red-600 dark:text-red-400`}
                     ${!n&&!r&&`text-amber-700 dark:text-amber-400`}
                  `,children:n?`Pago`:r?`Vencido`:`Aberto`})})]})},[t])})});function j(e){return[...e].sort((e,t)=>{let n=new Date(w(e.dueDate)).getTime(),r=new Date(w(t.dueDate)).getTime();if(n!==r)return n-r;let i=e.totalInstallments??1;return(t.totalInstallments??1)-i})}var M=[`Fixo`,`Variável`,`Cartão`];const N=(0,D.memo)(function({commitments:e,onSelect:t,showStatementInGroupHeaders:n=!1}){let r=(0,D.useMemo)(()=>{let t={Fixo:[],Variável:[],Cartão:[]};for(let n of e){let e=n.type===`Fixo`||n.type===`Variável`||n.type===`Cartão`?n.type:`Variável`;t[e]&&t[e].push(n)}let n=[];for(let e of M){let r=t[e];if(r.length===0)continue;if(e!==`Cartão`){n.push({type:e,items:r});continue}let i={};for(let e of r){let t=e.card||`Outros`;i[t]||(i[t]=[]),i[t].push(e)}for(let e of _){let t=i[e];t?.length&&n.push({type:`Cartão`,card:e,items:j(t)})}i.Outros?.length&&n.push({type:`Cartão`,card:`Outros`,items:j(i.Outros)})}return n},[e]);return r.length===0?(0,O.jsx)(A,{commitments:[],onSelect:()=>{}}):(0,O.jsx)(`div`,{className:`space-y-6`,children:r.map(e=>{e.type===`Cartão`&&e.card;let r=n?e.items.reduce((e,t)=>e+Number(t.amount),0):0;return(0,O.jsxs)(`section`,{"aria-labelledby":`group-${e.type}-${e.card??``}`,children:[(0,O.jsxs)(`h2`,{id:`group-${e.type}-${e.card??``}`,className:`text-sm font-semibold text-muted-foreground mb-2 px-0.5 flex flex-wrap items-baseline justify-between gap-2`,children:[(0,O.jsx)(`span`,{children:e.card?`${e.type} • ${e.card}`:e.type}),n&&r>0&&(0,O.jsx)(`span`,{className:`font-bold text-foreground text-base`,children:g(r)})]}),(0,O.jsx)(A,{commitments:e.items,onSelect:t})]},e.card?`${e.type}-${e.card}`:e.type)})})});function P({value:e,onChange:t,className:n}){return(0,O.jsxs)(`div`,{className:b(`flex flex-wrap items-center gap-2`,n),role:`group`,"aria-label":`Filtrar por tipo`,children:[(0,O.jsx)(F,{label:`Todos`,selected:e===null,onClick:()=>t(null)}),h.map(n=>(0,O.jsx)(F,{label:n,selected:e===n,onClick:()=>t(n)},n))]})}function F({label:e,selected:t,onClick:n}){return(0,O.jsx)(`button`,{type:`button`,onClick:n,className:b(`rounded-full px-3 py-1.5 text-sm font-medium transition-all duration-200`,`border focus:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 focus-visible:ring-offset-background`,t?`bg-primary text-primary-foreground border-primary shadow-sm`:`bg-background border-border text-muted-foreground hover:bg-accent hover:text-accent-foreground hover:border-accent`),children:e})}function I({value:e,onChange:t,className:n}){return(0,O.jsxs)(`div`,{className:b(`flex flex-wrap items-center gap-2`,n),role:`group`,"aria-label":`Filtrar por cartão`,children:[(0,O.jsx)(L,{label:`Todos`,selected:e===null,onClick:()=>t(null)}),_.map(n=>(0,O.jsx)(L,{label:n,selected:e===n,onClick:()=>t(n)},n))]})}function L({label:e,selected:t,onClick:n}){return(0,O.jsx)(`button`,{type:`button`,onClick:n,className:b(`rounded-full px-3 py-1.5 text-sm font-medium transition-all duration-200`,`border focus:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 focus-visible:ring-offset-background`,t?`bg-primary text-primary-foreground border-primary shadow-sm`:`bg-background border-border text-muted-foreground hover:bg-accent hover:text-accent-foreground hover:border-accent`),children:e})}function R({cardName:e,totalStatement:t,onPayStatement:n,isPaying:r,allPaid:i=!1}){return(0,O.jsxs)(`div`,{className:`flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 p-4 rounded-xl border border-border bg-card text-card-foreground shadow-sm`,role:`region`,"aria-label":`Fatura do cartão ${e}`,children:[(0,O.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,O.jsx)(`div`,{className:`flex h-10 w-10 items-center justify-center rounded-lg bg-primary/10 text-primary`,children:(0,O.jsx)(m,{className:`h-5 w-5`})}),(0,O.jsxs)(`div`,{children:[(0,O.jsxs)(`p`,{className:`text-sm font-medium text-muted-foreground`,children:[`Fatura `,e]}),(0,O.jsx)(`p`,{className:`text-xl font-bold text-foreground`,children:g(t)})]})]}),(0,O.jsx)(C,{onClick:n,disabled:r||i,className:i?`rounded-full bg-muted text-muted-foreground border border-border shrink-0 cursor-default`:`rounded-full bg-green-600 hover:bg-green-700 text-white border-0 shrink-0`,children:r?`Pagando…`:i?`Pago`:`Pagar fatura`})]})}var z=(0,D.lazy)(()=>i(()=>import(`./AddCommitmentModal-D87pCT7W.js`),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),B=(0,D.lazy)(()=>i(()=>import(`./EditCommitmentModal-CMFSr39Z.js`),__vite__mapDeps([13,1,2,3,4,5,6,7,14,15,11,16,10])));function V(){let{month:e,year:t}=x(),{commitments:i,isLoading:a,payCardStatement:o}=v(e,String(t)),[s,c]=(0,D.useState)(null),[l,u]=(0,D.useState)(!1),[d,f]=(0,D.useState)(null),[m,h]=(0,D.useState)(null),[_,b]=(0,D.useState)(!1),C=n(),w=()=>C(`/`),E=(0,D.useCallback)(e=>{f(e),e!==`Cartão`&&h(null)},[]),k=(0,D.useMemo)(()=>{let e=i;return d&&(e=e.filter(e=>e.type===d)),d===`Cartão`&&m&&(e=e.filter(e=>e.card===m)),e},[i,d,m]),A=(0,D.useMemo)(()=>k.filter(e=>!e.paymentDate),[k]),j=(0,D.useMemo)(()=>k.reduce((e,t)=>e+Number(t.amount),0),[k]),M=A.length===0,F=(0,D.useMemo)(()=>{let n=e===`all`?String(t):r(new Date(Number(t),Number(e)-1,1),`MMMM 'de' yyyy`,{locale:T});return`${e===`all`?n:n.charAt(0).toUpperCase()+n.slice(1)} • Total: ${g(k.reduce((e,t)=>e+Number(t.amount),0))}`},[e,t,k]),L=(0,D.useCallback)(async()=>{if(A.length===0)return;let e=new Date().toISOString().slice(0,10);b(!0);try{await o({rowIndexes:A.map(e=>e.rowIndex),paymentDate:e})}catch{}finally{b(!1)}},[A,o]);return a?(0,O.jsx)(y,{title:`Compromissos`,onBack:w,headerVariant:`commitment`,children:(0,O.jsx)(S,{})}):(0,O.jsxs)(y,{title:`Compromissos`,onBack:w,subtitle:F,headerVariant:`commitment`,children:[(0,O.jsxs)(`div`,{className:`space-y-4 pb-20`,children:[(0,O.jsxs)(`div`,{className:`space-y-3 pb-3 border-b border-border`,children:[(0,O.jsx)(P,{value:d,onChange:E}),d===`Cartão`&&(0,O.jsx)(I,{value:m,onChange:h})]}),d===`Cartão`&&m&&(0,O.jsx)(R,{cardName:m,totalStatement:j,onPayStatement:L,isPaying:_,allPaid:M}),(0,O.jsx)(N,{commitments:k,onSelect:c,showStatementInGroupHeaders:!m})]}),(0,O.jsx)(`button`,{type:`button`,onClick:()=>u(!0),className:`fixed bottom-6 right-6 z-50 flex h-14 w-14 items-center justify-center rounded-full bg-amber-600 text-white shadow-lg transition-all hover:bg-amber-700 dark:bg-amber-500 dark:hover:bg-amber-600 hover:shadow-xl focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900`,"aria-label":`Novo compromisso`,children:(0,O.jsx)(p,{className:`h-7 w-7`})}),l&&(0,O.jsx)(D.Suspense,{fallback:null,children:(0,O.jsx)(z,{isOpen:l,onClose:()=>u(!1)})}),s&&(0,O.jsx)(D.Suspense,{fallback:null,children:(0,O.jsx)(B,{isOpen:!!s,commitment:s,onClose:()=>c(null),onConfirm:()=>{}})})]})}export{V as default};